# Template according to #1613
# The first model in this block can be overridden
# in the command line by using:
# --model, --exp, --source, --outputdir, --catalog
datasets:
  - catalog: null
    model: null
    exp: null
    source: 'lra-r100-monthly'
    regrid: null
    reader_kwargs: null # it can be a dictionary with reader kwargs
    startdate: null
    enddate: null
  # Possible second/third/fourth datasets here, no present by default
  # - catalog: 'obs'
  #   model: 'ERA5'
  #   exp: 'era5'
  #   source: 'monthly'
  #   regrid: r100

references:
  - catalog: 'obs'
    model: 'CERES'
    exp: 'ebaf-toa421'
    source: 'monthly'
    regrid: 'r100'
    reader_kwargs: null
    startdate: '2001-01-01'
    enddate: '2024-12-31'
  - catalog: obs
    model: 'ERA5'
    exp: 'era5'
    regrid: 'r100'
    source: 'monthly'
    startdate: '1990-01-01'
    enddate: '2020-12-31'

output:
  outputdir: "./"
  rebuild: true
  save_pdf: true
  save_png: true
  dpi: 300
  create_catalog_entry: true

diagnostics:
  timeseries:
    run: true
    diagnostic_name: 'radiation_toa'
    variables: ['tnlwrf', 'tnswrf']
    formulae: ['tnlwrf+tnswrf']
    center_time: true
    params:
      default:
        hourly: False
        daily: False
        monthly: True
        annual: True
        std_startdate: '20010101' 
        std_enddate: '20241231'
      tnlwrf+tnswrf:
        standard_name: "net_top_radiation"
        long_name: "Net top radiation"

  globalbiases:
    run: true
    diagnostic_name: 'radiation_toa'
    variables: ['tnlwrf', 'tnswrf']
    formulae: ['tnlwrf+tnswrf', 'tnlwrf-tnlwrfcs', 'tnswrf-tnswrfcs', 'tnlwrf+tnswrf-tnlwrfcs-tnswrfcs']
    params:
      default:
        plev: null # Level plot for 2D bias map if variable 3d
        seasons: true
        seasons_stat: 'mean' # May become a list
        vertical: false     # Vertical profile if variable 3d
        startdate_data: null
        enddate_data: null
        startdate_obs: "2001-01-01"
        enddate_obs: "2024-12-31"
      tnlwrf+tnswrf:
        short_name: "tnr"
        long_name: "Top net radiation"
      tnlwrf-tnlwrfcs:
        short_name: "cre_toa_lw"
        long_name: "Long wave cloud radiative effect at TOA (All Sky - Clear Sky)"
      tnswrf-tnswrfcs:
        short_name: "cre_toa_sw"
        long_name: "Short wave cloud radiative effect at TOA (All Sky - Clear Sky)"
      tnlwrf+tnswrf-tnlwrfcs-tnswrfcs:
        short_name: "cre_toa_net"
        long_name: "Net cloud radiative effect at TOA (All Sky - Clear Sky)"
    plot_params: 
      default: 
        projection: 'robinson'
        projection_params: {}
      tnlwrf:
        vmin: -30
        vmax: 30
      tnswrf:
        vmin: -30
        vmax: 30
      tnr:
        vmin: -30
        vmax: 30
      cre_toa_net:
        vmin: -30
        vmax: 30
      cre_toa_sw:
        vmin: -30
        vmax: 30
      cre_toa_lw:
        vmin: -30
        vmax: 30

  boxplots:
    run: true
    diagnostic_name: 'radiation_toa'
    variables:
      - vars: ['-tnlwrf', 'tnswrf']
        add_mean_line: true
        anomalies: true