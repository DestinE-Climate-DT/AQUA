# Breakout Session Plan: AQUA Analysis and Catalog Management

## Agenda Overview
This session will cover the following key topics:
1. **Building the Boat:** Creation of a catalog entry and generating the LRA (Logical Resource Allocation).
2. **Sailing with AQUA:** Running the aqua-analysis and utilizing diagnostics.

## Session Structure

### 1. **Introduction and Overview (5 min)**
   - Brief introduction to the session objectives.
   - Quick overview of AQUA and its importance in catalog management.

### 2. **Building the Boat: Creation of Catalog Entry and LRA (10 min)**
   - **Objective:** Guide participants through creating a new catalog entry.
   - **Steps:**
     - Introduction to the catalog entry structure.
     - Hands-on creation of a catalog entry.
     - Generate and discuss the Logical Resource Allocation (LRA).

### 3. **Sailing with AQUA: Running the aqua_analysis (5-10 min)**
   - **Objective:** Demonstrate how to run the aqua-analysis tool.
   - **Steps:**
     - Overview of aqua-analysis and its role in diagnostics.
     - Step-by-step run-through of aqua_analysis.
     - Discuss common issues and how to troubleshoot them.

### 4. **Demonstration in the Notebook (25 min)**
   - **Objective:** Provide a live demonstration using a Jupyter notebook.
   - **Steps:**
     - Open a prepared notebook and walk through a typical analysis workflow.
     - Highlight key functions and their outputs.
     - Encourage participants to follow along or ask questions in real-time.

### 5. **Modification of YAML File (5 min)**
   - **Objective:** Teach how to modify the YAML file for custom analysis.
   - **Steps:**
     - Explain the structure and key elements of the YAML file.
     - Show how to make modifications to parameters and settings.
     - Discuss the impact of these modifications on the analysis output.

### 6. **aqua_analysis Output and Discussion (5 min)**
   - **Objective:** Review and interpret the output generated by aqua_analysis.
   - **Steps:**
     - Discuss typical output files and their significance.
     - Analyze a sample output and explain the key findings.
     - Briefly cover how to use these outputs for further diagnostics.

### 7. **Q&A Session (5 min)**
   - Open the floor for questions.
   - Address any issues or clarify doubts regarding the session content.
   - Encourage feedback and suggestions for improvement.

## Closing Remarks (Optional)
   - Recap the session’s key points.
   - Provide additional resources or references for further learning.
   - Thank participants for their time and engagement.

### 2. **Building the Boat: Creation of Catalog Entry and LRA (10 min)**

#### Catalog Entry Generator for FDB Sources

A tool that streamlines the process of adding new experiments to the catalog, based on the data-portfolio structure of the Destination Earth Climate DT. It exploits the capabilities of the Jinja package to obtain a cleaner and more flexible code.

**Basic Usage:**

To add a new experiment to the catalog, follow these steps:

1. Clone the two repositories, `DestinE-ClimateDT-catalog` and `data-portfolio`, to your preferred location.
2. Navigate to the `cli/fdb-catalog-generator` folder.
3. Update the `config.yaml` file with the details of your simulation, including the paths of the cloned repositories.
4. Run the command: 

   ```bash
   python catalog-jinja-generator.py -p production -c config.yaml
   ```

   where the `-p` argument can be either `production` or `reduced` to specify the Jinja template to be used.
   
5. The catalog entry will be created in the appropriate location in the `DestinE-ClimateDT-catalog` folder, and the corresponding `main.yaml` file will be automatically updated.

### 6. aqua_analysis Output and Discussion (5 min)

#### Overview
The `output` folder is organized to provide a clear, hierarchical structure of the analysis results. Each layer in the folder structure adds context to the data, making it easier to navigate and interpret.

#### Folder Structure Explanation

- **Model Level:**
  - The top-level directories represent different models or simulations.
- **Experiment Level:**
  - Within each model directory, you will find subdirectories corresponding to different experiments or simulation periods.
- **Diagnostic Level:**
  - Each experiment folder contains diagnostics, organized by their respective categories, such as time series, seasonal cycles, or specific climate phenomena.
- **Output Files:**
  - Inside diagnostic folders, you’ll find various output files:
    - **Log files** to trace the analysis process.
    - **PDF reports** providing visual summaries.
    - **NetCDF files** containing detailed data for further analysis.

#### Discussion Points
- **Navigating the Structure:** Understanding the hierarchy helps quickly locate the relevant analysis results.
- **Interpreting Output:** Discuss how the organization aids in comparing results across different experiments and diagnostics.
- **Utilizing Logs and Data:** Logs are essential for troubleshooting, while NetCDF files are key for in-depth analysis.
